<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Thailand 2026 — Übersicht</title>
<style>
:root{
  --accent:#0077b6; --accent2:#00b4d8; --bg:#f6f6f6; --card:#ffffff;
  --txt:#222;
  --gray1:#fbfbfb;
  --gray2:#f0f0f0;
  --overnight-bg:#e8f5ff;
  --overnight-accent:#2b95ff;
  --ov-badge-size:12px;
  --icon-size:18px;
}
*{box-sizing:border-box}
body{font-family:"Segoe UI",Arial,sans-serif;margin:0;background:var(--bg);color:var(--txt);}
.header{
  background:linear-gradient(90deg,var(--accent),#00629a);
  color:#fff;padding:12px 16px;display:flex;align-items:center;justify-content:space-between;
  gap:12px;
}
.header h1{margin:0;font-size:18px;font-weight:600}
.langBtns{display:flex;gap:8px}
button.langBtn{
  border:0;padding:8px 12px;border-radius:8px;background:var(--accent2);color:#fff;cursor:pointer;font-weight:700;
}
.container{max-width:1200px;margin:18px auto;padding:12px}
.card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
.controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:10px}
.small{font-size:13px;color:#444}

/* Table */
.table-wrap{overflow:auto;border-radius:8px}
table{width:100%;border-collapse:collapse;font-size:14px;text-align:center}
th,td{border:1px solid #e2e2e2;padding:8px;vertical-align:top}
thead th{position:sticky;top:0;background:#fafafa;z-index:5}
.sticky-date{position:sticky;left:0;background:#fff;z-index:6;font-weight:700;width:72px;min-width:64px}

/* entries - centered text */
.entry{display:block;padding:8px;margin:6px 0;border-radius:6px;text-align:center;border:1px solid rgba(0,0,0,0.03)}
.entry .meta{font-size:12px;color:#666;margin-bottom:4px}
.entry .text{font-size:14px}

/* alternating greys in overview - stronger contrast */
td .entry.odd { background: linear-gradient(180deg,var(--gray1),#f7f7f7); }
td .entry.even{ background: linear-gradient(180deg,var(--gray2),#efefef); }

/* overnight distinct */
.entry.overnight{ background: linear-gradient(90deg,var(--overnight-bg),#f4fbff); border-left:6px solid var(--overnight-accent); padding-left:10px; }
.entry.overnight .meta{ font-weight:700; color:var(--overnight-accent); }

/* overnight badge for overview (small color per person) */
.ov-badge{display:inline-block;width:var(--ov-badge-size);height:var(--ov-badge-size);border-radius:50%;vertical-align:middle;margin-right:8px;border:2px solid #fff;box-shadow:0 1px 2px rgba(0,0,0,0.08)}

/* person base colors (cell backgrounds kept in CSS if needed) */
.personColRouven{}
.personColDaniel{}
.personColHenrik{}
.personColBenja{}
.personColHolger{}

/* weekend darker variants */
.weekendDate{background:#ffd699;font-weight:700;color:#222}

/* editor styles */
.editorHeader{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:10px}
.personBadge{display:inline-flex;align-items:center;gap:10px}
.badgeCircle{width:36px;height:36px;border-radius:50%;display:inline-block}
.personName{font-weight:700;font-size:16px}
.editorGrid{display:grid;grid-template-columns:1fr 360px;gap:12px}
@media(max-width:980px){ .editorGrid{grid-template-columns:1fr} }

/* left column: calendar */
.entryBox{background:#fff;padding:10px;border-radius:8px;margin-bottom:10px;box-shadow:0 4px 10px rgba(0,0,0,0.03)}
.entryBox strong{display:inline-block;width:100px}
.entryRow{display:flex;gap:8px;align-items:center;margin-top:8px}
.entryRow input[type="text"]{padding:6px;border-radius:6px;border:1px solid #ddd;width:100%}
.smallBtn{padding:6px 8px;border-radius:6px;border:0;background:var(--accent2);color:#fff;cursor:pointer}

/* alternate greys in editor for entries */
.entryBox .entryRow.item-odd{ background: var(--gray1); border-radius:6px; padding:6px; margin-top:6px; display:flex; gap:8px; align-items:center; }
.entryBox .entryRow.item-even{ background: var(--gray2); border-radius:6px; padding:6px; margin-top:6px; display:flex; gap:8px; align-items:center; }
.entryBox .entryRow input[type="text"]{ border:0; background:transparent; padding:6px; width:100%; }

/* overnight row styling in editor */
.ov-inline{ background: var(--overnight-bg); border-left:6px solid var(--overnight-accent); padding:8px; border-radius:6px; display:flex; gap:8px; align-items:center; margin-top:8px; }

/* adopt UI */
.adopt-wrap{display:flex;gap:8px;align-items:center;margin-top:8px}
.adopt-wrap select{padding:6px;border-radius:6px;border:1px solid #ddd;min-width:220px}
.adopt-wrap .fancy-select{background:#fff;border:1px solid #ddd;padding:6px;border-radius:6px;box-shadow:inset 0 1px 0 rgba(0,0,0,0.02)}

/* right column: todos */
.sideCard{background:#fff;padding:10px;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,0.03)}
.sideCard h4{margin:0 0 8px 0}

/* todos */
.todo-item{display:flex;gap:6px;align-items:center;margin-bottom:8px}
.todo-item input[type="text"]{flex:1;padding:6px;border-radius:6px;border:1px solid #ddd}
.todo-actions button{padding:6px;border-radius:6px;border:0;background:#f0f0f0;cursor:pointer}

/* icon buttons */
.icon-btn{background:transparent;border:0;padding:4px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;border-radius:6px}
.icon-btn svg{width:var(--icon-size);height:var(--icon-size);opacity:0.9}
.icon-btn:hover{background:rgba(0,0,0,0.04)}

/* small helpers */
.kv{font-size:13px;color:#666}
.note{font-size:13px;color:#555;margin-top:8px}
</style>
</head>
<body>

<div class="header">
  <h1 id="pageTitle">Thailand 2026</h1>
  <div class="langBtns">
    <button class="langBtn" onclick="setLang('de')">Deutsch</button>
    <button class="langBtn" onclick="setLang('th')">ไทย</button>
  </div>
</div>

<div class="container">
  <div class="card">
    <div class="controls">
      <div class="small kv" id="rangeInfo"></div>
      <div style="flex:1"></div>
      <div class="small kv">Sprache: <strong id="langLabel">Deutsch</strong></div>
    </div>

    <!-- Übersicht -->
    <div id="overview">
      <div class="table-wrap">
        <table id="calendarTable" aria-label="Reiseübersicht">
          <thead id="calendarHead"></thead>
          <tbody id="calendarBody"></tbody>
        </table>
      </div>
      <p class="note">Klicke auf einen Namen, um die persönliche Seite (inline Editor) zu öffnen.</p>
    </div>

    <!-- Editor -->
    <div id="editor" style="display:none;margin-top:14px;">
      <div class="editorHeader">
        <div class="personBadge">
          <div class="badgeCircle" id="badgeColor"></div>
          <div>
            <div class="personName" id="editorName">Person</div>
            <div class="kv" id="editorSub">Bearbeiten — Einträge / Übernachtung / To-Dos</div>
          </div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <button class="smallBtn" onclick="closeEditor()">← <span id="closeLabel">Zurück</span></button>
          <div class="kv">Änderungen werden sofort gespeichert (localStorage)</div>
        </div>
      </div>

      <div class="editorGrid">
        <!-- left: calendar entries -->
        <div>
          <div id="personCalendarList"></div>
        </div>

        <!-- right: todos -->
        <div>
          <div class="sideCard">
            <h4 id="todoTitle">To-Do</h4>
            <div id="todoList"></div>
            <div style="margin-top:8px">
              <button class="smallBtn" onclick="addTodoItem()">+ Neue Aufgabe</button>
            </div>
          </div>
        </div>
      </div>

    </div>

  </div>
</div>
<!-- Teil 2 (Script) kommt direkt hier drunter kopiert -->

<script>
/* ===================
   Datenbasis
=================== */
const persons = ["Rouven","Daniel","Henrik","Benja","Holger"];
const startDate = new Date("2026-02-15");
const endDate = new Date("2026-03-20");

let data = loadData();
let currentPerson = null;
let currentLang = localStorage.getItem("lang") || "de";

/* Übersetzungen */
const t = {
  de:{
    overnight:"Übernachtung",
    adopt:"Übernehmen",
    entry:"Eintrag",
    addOvernight:"Übernachtung hinzufügen",
    todo:"To-Do",
    back:"Zurück",
    booked:"gebucht"
  },
  th:{
    overnight:"ที่พัก",
    adopt:"นำมาใช้",
    entry:"รายการ",
    addOvernight:"เพิ่มที่พัก",
    todo:"สิ่งที่ต้องทำ",
    back:"ย้อนกลับ",
    booked:"จองแล้ว"
  }
};

/* ===================
   Init + Helpers
=================== */
function loadData(){
  const ls = localStorage.getItem("tripData");
  if(ls){
    return JSON.parse(ls);
  } else {
    let d = createEmptyData();
    mergePresetInto(d);
    // Holger am 16.02. automatisch "Flugzeug"
    d.overnight["Holger"]["2026-02-16"] = {de:"Flugzeug",th:"เครื่องบิน",booked:false};
    localStorage.setItem("tripData",JSON.stringify(d));
    return d;
  }
}
function saveData(){localStorage.setItem("tripData",JSON.stringify(data));}

function createEmptyData(){
  let d = {entries:{},overnight:{},todos:{}};
  persons.forEach(p=>{
    d.entries[p]={};
    d.overnight[p]={};
    d.todos[p]=[];
  });
  return d;
}
function mergePresetInto(d){/* hier könntest du deine Presets laden */}

/* Sprache */
function setLang(lang){
  currentLang=lang;localStorage.setItem("lang",lang);
  document.getElementById("langLabel").textContent=(lang==="de"?"Deutsch":"ไทย");
  renderCalendar();if(currentPerson)renderPersonEditor(currentPerson);
}

/* ===================
   Kalender aufbauen
=================== */
function eachDate(from,to,cb){
  let d=new Date(from);
  while(d<=to){
    cb(new Date(d));
    d.setDate(d.getDate()+1);
  }
}

function formatDateKey(d){return d.toISOString().slice(0,10);}
function formatDate(d){
  return d.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"});
}

function renderCalendar(){
  const head=document.getElementById("calendarHead");
  const body=document.getElementById("calendarBody");
  head.innerHTML="";
  body.innerHTML="";
  let tr=document.createElement("tr");
  let th=document.createElement("th");th.className="sticky-date";th.textContent="Datum";tr.appendChild(th);
  persons.forEach(p=>{let th2=document.createElement("th");th2.textContent=p;tr.appendChild(th2);});
  head.appendChild(tr);
  eachDate(startDate,endDate,(date)=>{
    const key=formatDateKey(date);
    let tr=document.createElement("tr");
    let tdDate=document.createElement("td");
    tdDate.className="sticky-date"+(date.getDay()===0||date.getDay()===6?" weekendDate":"");
    tdDate.textContent=formatDate(date);
    tr.appendChild(tdDate);
    persons.forEach(p=>{
      let td=document.createElement("td");
      const entries=data.entries[p][key]||[];
      entries.forEach((en,i)=>{
        let div=document.createElement("div");
        div.className="entry "+(i%2?"even":"odd");
        div.innerHTML=`<div class="text">${en[currentLang]||""}</div>`;
        td.appendChild(div);
      });
      // overnight badge
      const ov=data.overnight[p][key];
      if(ov && (ov.de||ov.th)){
        let div=document.createElement("div");
        div.className="entry overnight";
        div.innerHTML=`<span class="ov-badge" style="background-color:${personColor(p)}"></span>
        <div class="meta">${t[currentLang].overnight}</div>
        <div class="text">${ov[currentLang]||""}${ov.booked?" ("+t[currentLang].booked+")":""}</div>`;
        td.appendChild(div);
      }
      td.addEventListener("click",()=>openEditor(p));
      tr.appendChild(td);
    });
    body.appendChild(tr);
  });
  document.getElementById("rangeInfo").textContent=
    formatDate(startDate)+" - "+formatDate(endDate);
}

function personColor(p){
  switch(p){
    case"Rouven":return"#ff8888";
    case"Daniel":return"#88ff88";
    case"Henrik":return"#88aaff";
    case"Benja":return"#ffcc88";
    case"Holger":return"#cc88ff";
  }
}

/* ===================
   Editor öffnen
=================== */
function openEditor(p){
  currentPerson=p;
  document.getElementById("editorName").textContent=p;
  document.getElementById("badgeColor").style.backgroundColor=personColor(p);
  document.getElementById("editor").style.display="block";
  document.getElementById("overview").style.display="none";
  renderPersonEditor(p);
}
function closeEditor(){
  currentPerson=null;
  document.getElementById("editor").style.display="none";
  document.getElementById("overview").style.display="block";
}

function renderPersonEditor(p){
  const list=document.getElementById("personCalendarList");
  list.innerHTML="";
  eachDate(startDate,endDate,(date)=>{
    const key=formatDateKey(date);
    let box=document.createElement("div");box.className="entryBox";
    let h=document.createElement("div");h.innerHTML=`<strong>${formatDate(date)}</strong>`;
    box.appendChild(h);
    // entries
    const entries=data.entries[p][key]||[];
    entries.forEach((en,i)=>{
      let row=document.createElement("div");row.className="entryRow item-"+(i%2?"even":"odd");
      row.innerHTML=`<input type="text" value="${en[currentLang]||""}" 
       oninput="updateEntry('${p}','${key}',${i},this.value)">`;
      let del=document.createElement("button");
      del.className="icon-btn";del.innerHTML=trashIcon();
      del.onclick=()=>deleteEntry(p,key,i);
      row.appendChild(del);
      box.appendChild(row);
    });
    let add=document.createElement("button");
    add.className="smallBtn";add.textContent="+ "+t[currentLang].entry;
    add.onclick=()=>addEntry(p,key);
    box.appendChild(add);
    // overnight except 12.03
    if(key!=="2026-03-12"){
      renderOvernightUI(box,p,key);
    }
    list.appendChild(box);
  });
  renderTodos(p);
}

function addEntry(p,key){
  if(!data.entries[p][key])data.entries[p][key]=[];
  data.entries[p][key].push({de:"",th:""});
  saveData();renderPersonEditor(p);
}
function updateEntry(p,key,i,val){
  data.entries[p][key][i][currentLang]=val;saveData();
}
function deleteEntry(p,key,i){
  data.entries[p][key].splice(i,1);saveData();renderPersonEditor(p);
}

/* Overnight UI */
function renderOvernightUI(box,p,key){
  const ov=data.overnight[p][key];
  let wrap=document.createElement("div");
  wrap.className="ov-inline";
  if(ov && (ov.de||ov.th)){
    // edit existing overnight
    wrap.innerHTML=`<input type="text" style="flex:1" value="${ov[currentLang]||""}" 
       oninput="updateOvernight('${p}','${key}',this.value)">
       <label><input type="checkbox" ${ov.booked?"checked":""}
       onchange="toggleBooked('${p}','${key}',this.checked)"> ${t[currentLang].booked}</label>`;
    let del=document.createElement("button");
    del.className="icon-btn";del.innerHTML=trashIcon();
    del.onclick=()=>deleteOvernight(p,key);
    wrap.appendChild(del);
  } else {
    // add new overnight
    let btn=document.createElement("button");
    btn.className="smallBtn";btn.textContent="+ "+t[currentLang].addOvernight;
    btn.onclick=()=>addOvernight(p,key);
    wrap.appendChild(btn);
    // adopt existing
    let opts=getAvailableOvernightsForAdopt(p,key);
    if(opts.length>0){
      let sel=document.createElement("select");
      sel.className="fancy-select";
      sel.innerHTML="<option value=''>"+t[currentLang].adopt+"…</option>"+opts.map(o=>`<option value="${o.val}">${o.txt}</option>`).join("");
      sel.onchange=function(){
        if(this.value){adoptOvernight(p,key,this.value);}
      };
      wrap.appendChild(sel);
    }
  }
  box.appendChild(wrap);
}

function addOvernight(p,key){
  data.overnight[p][key]={de:"",th:"",booked:false};
  saveData();renderPersonEditor(p);
}
function updateOvernight(p,key,val){
  data.overnight[p][key][currentLang]=val;saveData();
}
function toggleBooked(p,key,checked){
  data.overnight[p][key].booked=checked;saveData();
}
function deleteOvernight(p,key){
  delete data.overnight[p][key];saveData();renderPersonEditor(p);
}

function getAvailableOvernightsForAdopt(p,key){
  let res=[];
  persons.forEach(other=>{
    if(other===p)return;
    const ov=data.overnight[other][key];
    if(ov && ((ov.de && ov.de.trim())||(ov.th && ov.th.trim()))){
      res.push({val:JSON.stringify(ov),txt:`${other}: ${ov[currentLang]||""}`});
    }
  });
  return res;
}
function adoptOvernight(p,key,val){
  data.overnight[p][key]=JSON.parse(val);saveData();renderPersonEditor(p);
}

/* Todos */
function renderTodos(p){
  const list=document.getElementById("todoList");list.innerHTML="";
  data.todos[p].forEach((item,i)=>{
    let row=document.createElement("div");row.className="todo-item";
    row.innerHTML=`<input type="text" value="${item}" oninput="updateTodo('${p}',${i},this.value)">`;
    let del=document.createElement("button");del.className="icon-btn";del.innerHTML=trashIcon();
    del.onclick=()=>deleteTodo(p,i);row.appendChild(del);list.appendChild(row);
  });
}
function addTodoItem(){
  data.todos[currentPerson].push("");saveData();renderTodos(currentPerson);
}
function updateTodo(p,i,val){
  data.todos[p][i]=val;saveData();
}
function deleteTodo(p,i){
  data.todos[p].splice(i,1);saveData();renderTodos(p);
}

/* Icons */
function trashIcon(){
return `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<polyline points="3 6 5 6 21 6"></polyline>
<path d="M19 6L17.7 20.3a2 2 0 0 1-2 1.7H8.3a2 2 0 0 1-2-1.7L5 6"></path>
<path d="M10 11v6"></path><path d="M14 11v6"></path>
<path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"></path></svg>`;
}

/* Start */
renderCalendar();
setLang(currentLang);
</script>
</body>
</html>